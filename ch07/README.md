# Chapter07. 오류처리

> [@goo314](https://github.com/goo314), 2022-07-23

## 오류 코드보다 예외를 사용하라

- 함수를 호출한 즉시 오류를 확인(if-else)하는 것보다 오류가 발생하면 예외를 던지는 것이 낫다.

```typescript
// [7-1] 오류 플래그 설정

// [7-2] 오류를 발견하면 예외를 던진다
```

## Try-Catch-Finally 문부터 작성하라

- try-catch-finally문: try블록 안 코드를 실행하면 실행이 중단된 후 catch블록으로 넘어간다.
- 강제로 예외를 일으키는 테스트 케이스를 작성한 후 테스트를 통과하게 코드를 작성하는 방법을 권장한다.

```typescript
/* 파일을 열어 직렬화된 객체 몇 개를 읽어드리는 코드 */

// 잘못된 파일 접근을 시도했을때 예외를 던지는 코드 구현

// 예외 유형을 좁혀 FileNotFoundException을 잡아냄
```

## 미확인 예외를 사용하라

> 😶 확인 코드가 뭐지?

- method에 확인된 예외를 던졌는데 catch 블록이 세 단계 위에 있다면 그 사이 method 모두가 선언부에 해당 예외를 정의해야 한다.
- 하위 단계에서 코드를 변경하면 상위 단계 method 선언부를 전부 고쳐야 한다.

## 예외에 의미를 제공하라

- 예외를 던질때 전후 상황을 충분히 덧붙인다.

## 호출자를 고려해 예외 클래스를 정의하라

- 오류가 발생한 위치로 분류가 가능하다.
- 외부 API를 사용할 때 감싸기 기법
  - 외부 라이브러리와 프로그램 사이에서 의존성이 크게 줄어든다.

```typescript
/* 외부 라이브러리를 호출하는 try-catch-finally문 */

// 외부 라이브러리가 던질 예외를 모두 잡아내는 코드

// 호출하는 라이브러리 API를 감싸면서 예외 유형 하나를 반환
```

## 정상 흐름을 정의하라

- 특수 사례 패턴
  - 클래스를 만들거나 객체를 조작해 특수 사례를 처리하는 방식

```typescript
/* 비용 청구 애플리케이션에서 총계를 계산하는 코드 */

// 식비를 비용으로 청구했다면 직원이 청구한 식비를 총계에 더하고, 아니라면 일일 기본 식비를 총계에 더한다.

// 청구한 식비가 없다면 일일 기본 식비를 반환하는 MealExpense객체를 반환
```

## null을 반환하지 마라

- null을 반환하는 코드는 일거리를 늘릴 뿐만 아니라 호출자에게 문제를 떠넘긴다.
- null을 반환하고픈 유혹이 든다면 그 대신 예외를 던지거나 특수 사례 객체를 반환한다.

```typescript
// 한 줄 건너 하나씩 null을 확인하는 코드

// 특수 사례 객체를 이용한 코드
```

## null을 전달하지 마라

```typescript
/* 두 지점 사이의 거리를 계산하는 메서드 */
// null을 전달한다면?

// 새로운 예외 유형을 만들어 던지는 방법

// assert 문을 사용하는 방법
```

## 결론

- 깨끗한 코드는 읽기도 좋아야 하지만 안정성도 높아야 한다.
- 오류 처리를 프로그램 논의와 분리해 독자적인 사안으로 고려하면 튼튼하고 깨끗한 코드를 작성할 수 있다.
